angular.module("PlantsApp",["ionic","ui.router"]).directive("plantMainMenu",function(){return{restrict:"E",templateUrl:"app/menus/main.html"}}),function(){angular.module("PlantsApp").config(["$stateProvider","$urlRouterProvider",function(a,b){b.when("","/list"),b.when("/","/list"),b.when("/list","/list/"),a.state("list",{url:"/list/{name}",controller:"PlantListCtrl",templateUrl:"app/components/plant/list.html"}),a.state("detail",{url:"/detail/{code}",controller:"PlantDetailCtrl",templateUrl:"app/components/plant/detail.html"})}])}(),function(){function a(a,b,c,d){var e=b.code;a.getPhotoUrl=d.getPhotoUrl,c.getPlant(e).then(function(b){a.plant=b,d.query(b.scientific,function(b){console.log("photo queried",b);var c=d.getPhotos(b);a.photos=c,c.length>0&&(a.thumbnail=d.getPhotoUrl(c[0],d.SMALL),a.caption=c[0].title)})})}angular.module("PlantsApp").controller("PlantDetailCtrl",["$scope","$stateParams","plantList","flickr",a])}(),function(){function a(a,b,c){var d,e=b.name;e?(a.listName=e,d=c.getListPlants(e)):(a.listName=c.ALL_PLANTS,d=c.getPlants()),d.then(function(b){console.log(b),a.plants=b})}angular.module("PlantsApp").controller("PlantListCtrl",["$scope","$stateParams","plantList",a])}(),function(){function a(a,b){var c={THUMB:"t",SMALL:"m",MEDIUM:"z",LARGE:"b",getServiceUrl:function(a){return"https://www.flickr.com/services/rest/?method="+a},query:function(d,e){b.load(function(){var f=c.getServiceUrl("flickr.photos.search")+"&sort=relevance&per_page=10&format=json&text="+d+"&api_key="+b.get("flickr_api_key");return a.jsonp(f+"&jsoncallback=JSON_CALLBACK").success(e)})},getPhotos:function(a){return"ok"!=a.stat?[]:a.photos.photo},getPhotoUrl:function(a,b){return"https://farm"+a.farm+".staticflickr.com/"+a.server+"/"+a.id+"_"+a.secret+"_"+(b||c.THUMB)+".jpg"}};return c}angular.module("PlantsApp").factory("flickr",["$http","config",a])}(),function(){function a(a,b){function c(){return d||(console.log("Getting plants list"),d=a.get("assets/json/plants.json").then(function(a){e=a.data;for(var b=0;b<e.length;++b){var c=e[b];g[c.code]=c}return e})),d}var d,e,f="plant-lists",g={},h={ALL_PLANTS:"All Plants",getPlant:function(a){return c().then(function(){return g[a]})},getPlants:function(a){return c().then(function(b){if(!a)return b;for(var c=[],d=0;d<a.length;++d){var e=a[d];c.push(g[e])}return c})},getLists:function(){return b.getPromise(f,{})},getListPlants:function(a){return a==h.ALL_PLANTS?h.getPlants():h.getLists().then(function(b){return h.getPlants(b[a]||[])})},saveList:function(a,c){h.getLists().then(function(d){d[a]=c,b.set(f,d)})}};return h.getPlants().then(function(a){for(var b={},c=0;c<a.length;++c){var d=a[c];d.idYear&&(b[d.idYear]||(b[d.idYear]=[]),b[d.idYear].push(d.code))}angular.forEach(b,function(a,b){h.saveList(b+" Plants",a)})}),h}angular.module("PlantsApp").factory("plantList",["$http","storage",a])}(),function(){function a(a,b,c){b.all({all:c.getPlants(),lists:c.getLists()}).then(function(b){console.log(b);var d=[{name:c.ALL_PLANTS,count:b.all.length}];angular.forEach(b.lists,function(a,b){d.push({name:b,count:a.length})}),a.plantLists=d})}angular.module("PlantsApp").controller("MainMenuCtrl",["$scope","$q","plantList",a])}(),function(){function a(a){var b={get:function(b){return a.get("config-"+b)},set:function(b,c){a.set("config-"+b,c)},hasConfig:function(){return null!=b.get("version")},load:function(a){b.hasConfig()?a(b):b.update(a)},update:function(a){a(b)}};return b}angular.module("PlantsApp").factory("config",["storage",a])}(),function(){function a(a){var b={_data:{},get:function(a,c){return b._data[a]||(b._data[a]=JSON.parse(localStorage.getItem(a))||c)},set:function(a,c){b._data[a]=c,localStorage.setItem(a,JSON.stringify(c))},getPromise:function(c,d){return a(function(a){a(b.get(c,d))})}};return b}angular.module("PlantsApp").factory("storage",["$q",a])}(),angular.module("PlantsApp").run(["$templateCache",function(a){"use strict";a.put("app/components/plant/detail.html",'<ion-view><ion-nav-title>{{ plant.scientific }}</ion-nav-title><ion-content><h2>{{ plant.scientific }}</h2><h3>{{ plant.common }}</h3><a href="http://plants.usda.gov/core/profile?symbol={{plant.code}}">USDA</a><div class=plant-detail><div class=row><div class=col>Code</div><div class=col>{{ plant.code }}</div></div><div class=row><div class=col>Family</div><div class=col>{{ plant.family }} ({{ plant.familyCommon }})</div></div><div class=row><div class=col>Growth Form</div><div class=col>{{ plant.growth.join(\', \') }}</div></div></div><div class=plant-thumb><img src="{{ thumbnail }}"><div class=thumb-caption>{{ caption }}</div></div></ion-content></ion-view>'),a.put("app/components/plant/list.html",'<ion-view><ion-nav-title>{{ listName }}</ion-nav-title><ion-header-bar align-title=left class="bar-subheader bar-clear item-input-inset"><label class=item-input-wrapper><i class="icon ion-ios-search placeholder-icon"></i> <input type=search placeholder=Search ng-model=searchText> <button class="button ion-android-close button-dark button-clear" ng-show=searchText on-tap="searchText=\'\'"></button></label></ion-header-bar><ion-content><ion-list><ion-item collection-repeat="plant in plants | filter:searchText | orderBy:\'scientific\'" ui-sref=detail({code:plant.code}) ng-class="plant.idYear ? \'id-\' + plant.idYear : \'\'"><span class=col-code>{{ plant.code }}</span> <span class=col-scientific>{{ plant.scientific }}</span> <span class=col-growth><span ng-repeat="form in plant.growth" ng-class="\'growth-\' + form.toLowerCase().split(\'/\')[0]">{{ form == "Fern" ? "Fn" : form[0] }}</span></span></ion-item></ion-list></ion-content></ion-view>'),a.put("app/menus/main.html",'<ion-header-bar class="bar bar-header bar-balanced"><h1 class=title>Plant Lists</h1></ion-header-bar><ion-content has-header=true ng-controller=MainMenuCtrl><ion-list><ion-item ng-repeat="list in plantLists" ui-sref=list({name:list.name}) menu-close>{{ list.name }} ({{ list.count }})</ion-item></ion-list></ion-content>')}]);
//# sourceMappingURL=app.min.js.map